library(TCGAbiolinks)
library(edgeR)
library(SummarizedExperiment)
library(biomaRt)


### mRNA ### 
project_name <- "TCGA-LUAD"
query <- GDCquery(project = project_name,
                  data.category = "Transcriptome Profiling",
                  data.type = "Gene Expression Quantification", 
                  experimental.strategy = "RNA-Seq",
                  workflow.type = "STAR - Counts", 
                  sample.type = c("Primary Tumor", "Solid Tissue Normal"))

GDCdownload(query, files.per.chunk = 6)
tcga_data <- GDCprepare(query)

cancer_name <- tolower(sub("TCGA-", "", project_name))
file_name <- paste0("counts_", cancer_name, ".rds")

saveRDS(tcga_data, file = file_name, compress = FALSE)



### miRNA ### 

query_mirna <- GDCquery(project = project_name,
                  data.category = "Transcriptome Profiling",
                  data.type = "miRNA Expression Quantification",
                  workflow.type = "BCGSC miRNA Profiling",
                  sample.type = c("Primary Tumor", "Solid Tissue Normal"))

GDCdownload(query_mirna, files.per.chunk = 6)
tcga_mirna_data <- GDCprepare(query_mirna)
mirna_file_name <- paste0("mirna_counts_", cancer_name, ".rds")
saveRDS(tcga_mirna_data, file = mirna_file_name, compress = FALSE)

